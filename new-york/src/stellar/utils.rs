use ed25519_dalek::{ed25519::signature::SignerMut, SigningKey, VerifyingKey};
use sha2::{Digest, Sha256};
use stellar_xdr::curr::{
    DecoratedSignature, Hash, Limits, ReadXdr, Signature, SignatureHint, Transaction,
    TransactionEnvelope, TransactionSignaturePayload, TransactionSignaturePayloadTaggedTransaction,
    TransactionV1Envelope, WriteXdr,
};

pub fn hash_transaction(
    tx: &Transaction,
    network_passphrase: &str,
) -> Result<[u8; 32], stellar_xdr::curr::Error> {
    let signature_payload = TransactionSignaturePayload {
        network_id: Hash(Sha256::digest(network_passphrase).into()),
        tagged_transaction: TransactionSignaturePayloadTaggedTransaction::Tx(tx.clone()),
    };
    Ok(Sha256::digest(signature_payload.to_xdr(Limits::none())?).into())
}

pub fn ed25519_sign(secret_key: &str, payload: &[u8]) -> (VerifyingKey, [u8; 64]) {
    let mut signing = SigningKey::from_bytes(
        &stellar_strkey::ed25519::PrivateKey::from_string(secret_key)
            .unwrap()
            .0,
    );

    (
        signing.verifying_key(),
        signing.sign(payload).to_bytes().try_into().unwrap(),
    )
}

pub fn sign_transaction(tx: Transaction, network_passphrase: &str, secret_key: &str) -> String {
    let tx_hash = hash_transaction(&tx, network_passphrase).unwrap();
    let (verifying, tx_signature) = ed25519_sign(secret_key, &tx_hash);

    let decorated_signature = DecoratedSignature {
        hint: SignatureHint(verifying.to_bytes()[28..].try_into().unwrap()),
        signature: Signature(tx_signature.try_into().unwrap()),
    };

    let envelope = TransactionEnvelope::Tx(TransactionV1Envelope {
        tx: tx.clone(),
        signatures: [decorated_signature].try_into().unwrap(),
    });

    envelope.to_xdr_base64(Limits::none()).unwrap()
}

pub async fn sign_and_send_tx(envelope: String, secret_key: [u8; 32]) -> anyhow::Result<()> {
    let stellar_secret_key = stellar_strkey::ed25519::PrivateKey(secret_key).to_string();

    println!("{}", envelope);
    let tx = Transaction::from_xdr_base64(envelope.clone(), Limits::none());
    println!("{:?}", tx);
    let signed = sign_transaction(
        tx.unwrap(),
        "Test SDF Network ; September 2015",
        &stellar_secret_key,
    );

    let response = reqwest::Client::new()
        .post(format!("https://horizon-testnet.stellar.org/transactions"))
        .header("Content-Type", "application/x-www-form-urlencoded")
        .body(format!("tx={}", urlencoding::encode(&signed)))
        .send()
        .await?
        .text()
        .await?;

    println!("Executed transaction, response: {}\n", response);

    Ok(())
}

#[test]
fn test() {
    let stellar_secret_key = stellar_strkey::ed25519::PrivateKey([0; 32]).to_string();

    let tx = Transaction::from_xdr_base64("AAAAAA7TmOw1jC8N93f2EUWPVY3IIZPdTTZJX1IOVoTOVx1GADE1ZAASudEAAAABAAAAAAAAAAAAAAABAAAAAAAAABgAAAAAAAAAAZ39VKzJJsr6ni9mHFG/nbFIqygs/3auu9vV9Phn8naZAAAACWJvb3RzdHJhcAAAAAAAAAIAAAAOAAAAQDhlZjY3ZjI1M2UyNGYxMGY1ZTUwNTFiZGVkMjllMWMzYjBhZjQzNWUxYjYzMjY1MTg2OWNlMWRlOGQ5YmUzMjAAAAAOAAAnHDA0MDAwMjAwODEwMDAwMDAwMDAwMDAwMDkzOWE3MjMzZjc5YzRjYTk5NDBhMGRiMzk1N2YwNjA3ZTgxZmJmMjhjNzdlM2EwMmIyZTY4NGFhYTI4ZjJlNjcwMDAwMDAwMDA1MDEwMjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMWNjNmExN2FiNzk5ZTlhNjkzZmFjNzUzNmJlNjFjMTJlZTFlMGZhYmFkYTgyZDBjOTk5ZTA4Y2NlZTJhYTg2ZGU3N2IwODcwZjU1OGM1NzBlN2ZmZTU1ZDZkNDdmYTA0MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDEwMDAwMDAwMDBlNzAyMDYwMDAwMDAwMDAwNDdhMWNjMDc0YjkxNGRmODU5NmJhZDBlZDEzZDUwZDU2MWFkMWVmZmM3ZjdjYzUzMGFiODZkYTdlYTQ5ZmZjMDNlNTdlN2RhODI5ZjhjYmE5YzYyOWMzOTcwNTA1MzIzMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOWRhY2U4ZTdiZTM4OThhNGE1NWNmNmZiY2EzMmY1ZGQ5MGQyM2U5ZGQ5MDM5NjJjODgxNzFiOGUwMTFjZjBjZTA1MGVmMTI3NDM5MDIzZWE1MTY5OTdjY2RkNGVkNTM3YjI3MGI3NTJjNWYzZjRkZjNkNGJmMTVlOTAxNzVhNjQ4ZDY0NTlmMWExZDZkM2FhZTQ4YjYwZTc0ZDhlMDRkMTZmNjBjMThjNzA4YjQ4MjdlZTM2ODAwZTQxZmEzZTFjYzQ4YzcyZTE4NGJlOGUxZDczMmRlYWIyNmZkNTlhMjI5ZmYzMmE0ODczYzY1Y2VmZDMzMmMzYjNiODliNjRjODgzY2E0MWJjMTY2ZWY0ZGY1YzFlY2U1YTYwYjZmMWE5MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwOTNkN2E5MWRhOWYwODJlMzkzNDZhNGIwNGVmYmJjNDJmZjMyNThhYzYzMTAzNzhmMmRjNmE2ZDE0MTdjODc0YjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBjYzEwMDAwMGNkZjI2MTY0MTA5MTQzYWY5MzEwMjA5ZGJlOWFmZWY0ZTNiOThhY2MzOGEzZTE1Y2RlNzc4MGZkODZkOTUzNzFmMGJhNzY5M2ViMjQ2ZjZiNWFjY2U2Yzc1MjI1NDJhYWRiZTBmMGZjYmNlMTkyMTNhMjk1NTIzYWZlNTc3OGEwNDU2ZGI3Mzg3MjM3NjE3MGUwOGRkMDBlZWU1ZTU2YThmYTNjZTgxNDI1N2YxODc4ZGZlZTZhZWJhMzBhY2U5MDE5OWZlYjY5NDc0NTA1NmI1MzYwMGE1NmExMWI1ZmQxNDhlYzlhMmZlZTIyMzY2ZjE5YmIzOGU5MzMyNTVjZmUwNjAwNDYxMDAwMDAwMjAyMTgxYTAzZmYwMDA2MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxNTAwMDAwMDAwMDAwMDAwZTcwMDAwMDAwMDAwMDAwMGU1YTNhN2I1ZDgzMGMyOTUzYjk4NTM0YzZjNTlhM2EzNGZkYzM0ZTkzM2Y3ZjU4OThmMGE4NWNmMDg4NDZiY2EwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwZGM5ZTJhN2M2Zjk0OGYxNzQ3NGUzNGE3ZmM0M2VkMDMwZjdjMTU2M2YxYmFiZGRmNjM0MGM4MmUwZTU0YThjNTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAyMDAwNjAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwYTJiYjRlOTVlNDY5YzU3ZGE4N2NjMjQ5M2U1NjdjMWFlOGY0NTE5MGQ4NDFkOTQwZjRlODY5MTIzZGM0YjBlYTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwNjc1MWJiNjlmMDg2MWRmZTYzNzQyNWZmYTYwOTkyZGVkMTQyZjA0ZjQ3NmFiZTY4NGQwNjQ5YTA1ZDA1MmUyMTlkNzcwZGJkMGFjZmU1NDliNDcxZmExYjdmZGRmMjFmYjE4ODNiZmM0NTRiYzEyNTQyYjhmZjAzODAwNzQ4MTIwMDAwMDAxMDIwMzA0MDUwNjA3MDgwOTBhMGIwYzBkMGUwZjEwMTExMjEzMTQxNTE2MTcxODE5MWExYjFjMWQxZTFmMDUwMDVlMGUwMDAwMmQyZDJkMmQyZDQyNDU0NzQ5NGUyMDQzNDU1MjU0NDk0NjQ5NDM0MTU0NDUyZDJkMmQyZDJkMGE0ZDQ5NDk0NTM4NDQ0MzQzNDI0YTY1Njc0MTc3NDk0MjQxNjc0OTU2NDE0OTRhMzA1MjczNmU1MjJiNmE1MzMyNWE0YzczNGQ0ZjU1NjE0OTMwNTk1MTM4NzY2MzRlNGY0ZDQxNmY0NzQzNDM3MTQ3NTM0ZDM0Mzk0MjQxNGQ0MzBhNGQ0ODQxNzg0OTZhNDE2NzQyNjc0ZTU2NDI0MTRkNGQ0NzU1NmM3NTY0NDc1NjczNDk0NjRlNDg1NzQzNDI1MTUxMzA3MzY3NTU0Nzc4Njg2NDQ3NWE3NjYzNmQzMDY3NTEzMDQ1Nzg0NzZhNDE1OTQyNjc0ZTU2NDI0MTZmNGQwYTQ1NTU2Yzc1NjQ0NzU2NzM0OTQ1NGU3NjYzNmU0Mjc2NjM2ZDQ2MzA2MTU3Mzk3NTRkNTI1MTc3NDU2NzU5NDQ1NjUxNTE0ODQ0NDE3NDU0NTk1NzM1MzA1OTUzNDI0NDYyNDc0Njc5NTk1NDQ1NGM0ZDQxNmI0NzQxMzE1NTQ1MGE0MzQxNzc0MzUxMzA0NTc4NDM3YTQxNGE0MjY3NGU1NjQyNDE1OTU0NDE2YzU2NTQ0ZDQyMzQ1ODQ0NTQ0OTMwNGQ0NDU5Nzg0ZDQ0NDEzNDRkNDQ2NzMxNGQ2YzZmNTg0NDU0NGQ3ODRkNDQ1OTc4NGQ0NDQxMzQ0ZDQ0NjczMTBhNGQ2YzZmNzc2MzQ0NDU2OTRkNDM0MTQ3NDEzMTU1NDU0MTc3Nzc1YTUzNTczNTMwNWE1Nzc3Njc1NTMwNjQ1OTQ5NDY0MjQ0NTM3OTQyNDQ1YTU4NGEzMDYxNTc1YTcwNTkzMjQ2MzA1YTU0NDU2MTRkNDI2NzQ3NDEzMTU1NDUwYTQzNjc3NzUyNTM1NzM1MzA1YTU3Nzc2NzUxMzIzOTc5NjM0NzM5Nzk1OTU4NTI3MDYyMzIzNDc4NDY0NDQxNTM0MjY3NGU1NjQyNDE2MzRkNDMzMTRlNjg2MjZlNTI2ODQ5NDU0ZTczNTk1ODRhNjg0ZDUxNzM3NzQzNTE1OTQ0MGE1NjUxNTE0OTQ0NDE0YTQ0NTE1NDQ1NGM0ZDQxNmI0NzQxMzE1NTQ1NDI2ODRkNDM1NjU2NGQ3NzU3NTQ0MTU0NDI2NzYzNzE2ODZiNmE0ZjUwNTE0OTQyNDI2NzY3NzE2ODZiNmE0ZjUwNTE0ZDQyNDI3NzRlNDM0MTQxNTEzMTBhNDk0MjQxMzc2ZDcyMzM3NzY5NzI3OTM2NTg0OTY1NGMzNzQ5NmM0NTQ2NDY0NDQ1NmI2YzcxNDc0YTc5NTc1NTM1N2E2MjQ4NmM2ZjM2NjQzMzQ3NGY0YTM5NDI0MTU0NTE3YTU4NDQ0YzQxNmU2MTMyNjQ1ODM1Nzk1OTZlNzYwYTJiNDg0YzQ0NTQ2ODczNTg1MDQ2NzczODZhNjY2OTRkNzk2ZTU3MzU2ZjM0NDk0NDQ0NDQ0MzQzNDE3NzY3Nzc0ODc3NTk0NDU2NTIzMDZhNDI0MjY3Nzc0NjZmNDE1NTZjNTczOTY0N2E2MjMwNjIzNDY1NmM0MTUzNjM2ZTU1MGEzOTQ0NTA0ZjQxNTY2MzRjMzM2YzUxNzc2MTc3NTk0NDU2NTIzMDY2NDI0NzUxNzc1OTZhNDI2NzZmNDYzNjY3NTg0OTVhNjE2MTQ4NTIzMDYzNDg0ZDM2NGM3OTM5Njg2MzQ3NmI3NTY0NDg0YTMxNjMzMzUyNmM1YTQ4NGU2YzBhNjM2ZTVhNzA1OTMyNTY3YTRjNmQ2Yzc1NjQ0NzU2NzM0YzZkNGU3NjYyNTMzOTdhNWEzMzY3NzY1OTMyNTY3OTY0NDc2YzZkNjE1NzRlNjg2NDQ3NmM3NjYyNjkzOTMyNGU0MzM5Nzc1OTMyNzQ2YTYzNmQ3NzJmNTkzMjQ1MzkwYTYzNDc3ODY4NjQ0NzVhNzY2MzZkMzA2ZDVhNTczNTZhNjIzMjUyNzA2MjZkNjMzOTVhNDc1Njc5NGQ0MjMwNDc0MTMxNTU2NDQ0Njc1MTU3NDI0MjU0NWE2Yzc2Mzk2YTY4NDk0OTQzNmQ1OTc1NmQ1Nzc5Nzk3NjczNTMzNTQzMGE1NjcwNzM1NjQ2NmE0MTRmNDI2NzRlNTY0ODUxMzg0MjQxNjYzODQ1NDI0MTRkNDM0MjczNDE3NzQ0NDE1OTQ0NTY1MjMwNTQ0MTUxNDgyZjQyNDE0OTc3NDE0NDQzNDM0MTZhNmI0NzQzNTM3MTQ3NTM0OTYyMzQ1NDUxNDU0ZTBhNDE1MTUzNDM0MTY5NmY3NzY3Njc0OTZkNGQ0MjM0NDc0MzY5NzE0NzUzNDk2MjM0NTQ1MTQ1NGU0MTUxNDU0NTQ1NDgzMDUwNzQ0Mzc5NjQzNzZjNWE0NTRjNDU2ZTYzN2EzMTUzNmEyZjY0Mzg3NzY3Njc0NjZhNDI2NzZmNzEwYTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzRkNDk0OTQyNTU3YTQxNTE0MjY3NzM3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQxNTE0OTQyNDE2YTQxNTE0MjY3NzM3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQxNjc0OTQyMGE0MTZhNDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjQ0NTE0NTQzNDE3NzQ5NDI0MTZhNDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjQ0NTE0NTQzNDI0MTQ5NDI0MTZhNDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjBhNDQ1MTQ1NDM0MjUxNDk0MjQxN2E0MTUxNDI2NzczNzE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDM0MjY3NDk0MjQxNTQ0MTUxNDI2NzczNzE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDM0Mjc3NDk0MjQxNDQ0MTUxNDI2NzczNzEwYTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQzNDE0OTQyNDE3YTQxNTE0MjY3NzM3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQzNTE0OTQyNDE0NDQxNTE0MjY3NzM3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQzNjc0OTQyMGE0MTQ0NDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjQ0NTE0NTQzNDM3NzQ5NDI0MTQ0NDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjQ0NTE0NTQzNDQ0MTQ5NDI0MTQ0NDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjBhNDQ1MTQ1NDM0NDUxNDk0MjQxNDQ0MTUxNDI2NzczNzE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDM0NDY3NDk0MjQxNDQ0MTUxNDI2NzczNzE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDM0NDc3NDk0MjQxNDQ0MTUxNDI2NzczNzEwYTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQ1NDE0OTQyNDE0NDQxNTE0MjY3NzM3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQ1NTE0OTQyNDM3YTQxNjY0MjY3NzM3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0MzQ1Njc1MTUxMGE0MTY3NDk0MzQxNjc0ZDQyNDE0MTRkNDE0MTQxNDE0MTQxNDE0MTQxNDE0NDQxNTE0MjY3NmY3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0NDQyNDE0OTQxNDE0NDQxNTU0MjY3NmY3MTY4NmI2OTQ3MmI0NTMwNDI0NDUxNDU0NTBhNDI0MTYxNzc3NzQ3Mzg0MTQxNDE0MTc3NDQ3NzU5NGI0YjZmNWE0OTY4NzY2ODRlNDE1MTMwNDI0MjUxNmY0MjQxNTQ0MTY1NDI2NzZmNzE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDc0MjQyNDEzNTU1MmY0MTY4NmQ3YTc3MmIwYTUyNGY0ZDczNjU3OTMyNTg3MDUyNzU1NTRkNDU1MTQ3NDM2OTcxNDc1MzQ5NjIzNDU0NTE0NTRlNDE1MTYzNzc0ZTZhNDE1MTQyNjc3MzcxNjg2YjY5NDcyYjQ1MzA0MjQ0NTE0NTQ4NDE1MTQ1NDIyZjdhNDE1MTQyNjc3MzcxMGE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDg0MTY3NDU0MjQxNDQ0MTUxNDI2NzczNzE2ODZiNjk0NzJiNDUzMDQyNDQ1MTQ1NDg0MTc3NDU0MjJmN2E0MTRiNDI2NzY3NzE2ODZiNmE0ZjUwNTE1MTQ0NDE2NzRlNDg0MTQ0NDI0NTBhNDE2OTQxMzY1NzMxNmIzMzM1NjI2NzUzNjc0ZjZkNmU1NjRkNjk2MjMyMzA0ZDY4NjkzODM3Nzk3MTQyMzg2NTRjNzczMjY5MzE1MjU1NDU3MDM4NzQ1MjJmNTE0OTY3NGQzMzQzMzQ0ZjVhNzgzOTUwNGQzOTU4Njc3MTU5NzQwYTYyMzk2NTc5NmI0MzU5Mzc1NjU3NGM1OTRhNDc0MTRjNjczMjQ2NzUzNTYxNTc1NjQxNDk3NzNkMGEyZDJkMmQyZDJkNDU0ZTQ0MjA0MzQ1NTI1NDQ5NDY0OTQzNDE1NDQ1MmQyZDJkMmQyZDBhMmQyZDJkMmQyZDQyNDU0NzQ5NGUyMDQzNDU1MjU0NDk0NjQ5NDM0MTU0NDUyZDJkMmQyZDJkMGE0ZDQ5NDk0MzZjNmE0MzQzNDE2YTMyNjc0MTc3NDk0MjQxNjc0OTU2NDE0YTU2NzY1ODYzMzIzOTQ3MmI0ODcwNTE0NTZlNGEzMTUwNTE3YTdhNjc0NjU4NDMzOTM1NTU0ZDQxNmY0NzQzNDM3MTQ3NTM0ZDM0Mzk0MjQxNGQ0MzBhNGQ0NzY3Nzg0NzZhNDE1OTQyNjc0ZTU2NDI0MTRkNGQ0NTU1NmM3NTY0NDc1NjczNDk0NjRlNDg1NzQzNDI1MzYyMzIzOTMwNDk0NTRlNDI0ZDUyNmY3NzQ3NDE1OTQ0NTY1MTUxNGI0NDQyNDY0YTYyNmU1MjZjNjI0MzQyNDQwYTYyMzM0YTc3NjIzMzRhNjg2NDQ3NmM3NjYyNmE0NTU1NGQ0MjQ5NDc0MTMxNTU0NTQyNzc3NzRjNTUzMjQ2NzU2NDQ3NDU2NzUxMzI3ODY4NjM2ZDQ1Nzg0MzdhNDE0YTQyNjc0ZTU2NDI0MTY3NGQ0MTZiNGU0MjRkNTE3Mzc3MGE0MzUxNTk0NDU2NTE1MTQ3NDU3NzRhNTY1NTdhNDE2NTQ2NzczMDc4NGY0NDQxMzE0ZDZhNDU3ODRkNDQ1NTc3NGQ1NDQyNjE0Njc3MzA3YTRkN2E0MTMxNGQ2YTQ1Nzg0ZDQ0NTU3NzRkNTQ0MjYxNGQ0ODQxNzg0OTZhNDE2NzBhNDI2NzRlNTY0MjQxNGQ0ZDQ3NTU2Yzc1NjQ0NzU2NzM0OTQ2NGU0ODU3NDM0MjUxNTEzMDczNjc1NTQ3Nzg2ODY0NDc1YTc2NjM2ZDMwNjc1MTMwNDU3ODQ3NmE0MTU5NDI2NzRlNTY0MjQxNmY0ZDQ1NTU2Yzc1NjQ0NzU2NzMwYTQ5NDU0ZTc2NjM2ZTQyNzY2MzZkNDYzMDYxNTczOTc1NGQ1MjUxNzc0NTY3NTk0NDU2NTE1MTQ4NDQ0MTc0NTQ1OTU3MzUzMDU5NTM0MjQ0NjI0NzQ2Nzk1OTU0NDU0YzRkNDE2YjQ3NDEzMTU1NDU0MzQxNzc0MzUxMzA0NTc4MGE0MzdhNDE0YTQyNjc0ZTU2NDI0MTU5NTQ0MTZjNTY1NDRkNDY2Yjc3NDU3NzU5NDg0YjZmNWE0OTdhNmEzMDQzNDE1MTU5NDk0YjZmNWE0OTdhNmEzMDQ0NDE1MTYzNDQ1MTY3NDE0NTRlNTM0MjJmMzc3NDMyMzE2YzU4NTM0ZjBhMzI0Mzc1N2E3MDc4NzczNzM0NjU0YTQyMzczMjQ1Nzk0NDQ3Njc1NzM1NzI1ODQzNzQ3ODMyNzQ1NjU0NGM3MTM2Njg0YjZiMzY3YTJiNTU2OTUyNWE0MzZlNzE1MjM3NzA3MzRmNzY2NzcxNDY2NTUzNzg2YzZkNTQ2YzRhNmMwYTY1NTQ2ZDY5MzI1NzU5N2EzMzcxNGY0Mjc1N2E0MzQyNzU0NDQxNjY0MjY3NGU1NjQ4NTM0ZDQ1NDc0NDQxNTc2NzQyNTE2OTVhNTE3YTU3NTc3MDMwMzA2OTY2NGY0NDc0NGE1NjUzNzYzMTQxNjI0ZjUzNjM0NzcyNDQ0MjUzMGE0MjY3NGU1NjQ4NTIzODQ1NTM3YTQyNGE0ZDQ1NjU2NzUyNjE0MjQ0Njg2YjQ2NmY2NDQ4NTI3NzYzN2E2Zjc2NGMzMjRlNmM2MzZlNTI3MDVhNmQ2YzZhNTk1ODUyNmM2Mzc5MzUzMDYzNmU1NjdhNjQ0NzU2NmI2MzMyNTY3OTBhNjQ2ZDZjNmE1YTU4NGQ3NTYxNTczNTMwNWE1Nzc3NzU1OTMyMzk3NDRjMzA2Yzc1NjQ0NzU2NzM1NTMwNjQ1OTU1NmQzOTc2NjQ0NTRlNDI0YzZkNTI2YzYzNmE0MTY0NDI2NzRlNTY0ODUxMzQ0NTQ2Njc1MTU1NmM1NzM5NjQwYTdhNjIzMDYyMzQ2NTZjNDE1MzYzNmU1NTM5NDQ1MDRmNDE1NjYzNGMzMzZjNTE3NzQ0Njc1OTQ0NTY1MjMwNTA0MTUxNDgyZjQyNDE1MTQ0NDE2NzQ1NDc0ZDQyNDk0NzQxMzE1NTY0NDU3NzQ1NDIyZjc3NTE0OTRkNDE1OTQyMGE0MTY2Mzg0MzQxNTE0MTc3NDM2NzU5NDk0YjZmNWE0OTdhNmEzMDQ1NDE3NzQ5NDQ1Mjc3NDE3NzUyNDE0OTY3NTg3MzU2NmI2OTMwNzcyYjY5MzY1NjU5NDc1NzMzNTU0NjJmMzIzMjc1NjE1ODY1MzA1OTRhNDQ2YTMxNTU2NTBhNmU0MTJiNTQ2YTQ0MzE2MTY5MzU2MzQzNDk0MzU5NjIzMTUzNDE2ZDQ0MzU3ODZiNjY1NDU2NzA3NjZmMzQ1NTZmNzk2OTUzNTk3ODcyNDQ1NzRjNmQ1NTUyMzQ0MzQ5Mzk0ZTRiNzk2NjUwNGUyYjBhMmQyZDJkMmQyZDQ1NGU0NDIwNDM0NTUyNTQ0OTQ2NDk0MzQxNTQ0NTJkMmQyZDJkMmQwYTJkMmQyZDJkMmQ0MjQ1NDc0OTRlMjA0MzQ1NTI1NDQ5NDY0OTQzNDE1NDQ1MmQyZDJkMmQyZDBhNGQ0OTQ5NDM2YTdhNDM0MzQxNmE1MzY3NDE3NzQ5NDI0MTY3NDk1NTQ5NmQ1NTRkMzE2YzcxNjQ0ZTQ5NmU3YTY3Mzc1MzU2NTU3MjM5NTE0NzdhNmI2ZTQyNzE3Nzc3NDM2NzU5NDk0YjZmNWE0OTdhNmEzMDQ1NDE3NzQ5NzcwYTYxNDQ0NTYxNGQ0MjY3NDc0MTMxNTU0NTQxNzc3NzUyNTM1NzM1MzA1YTU3Nzc2NzU1MzA2NDU5NDk0NjRhNzY2MjMzNTE2NzUxMzA0NTc4NDc2YTQxNTk0MjY3NGU1NjQyNDE2ZjRkNDU1NTZjNzU2NDQ3NTY3MzQ5NDU0ZTc2MGE2MzZlNDI3NjYzNmQ0NjMwNjE1NzM5NzU0ZDUyNTE3NzQ1Njc1OTQ0NTY1MTUxNDg0NDQxNzQ1NDU5NTczNTMwNTk1MzQyNDQ2MjQ3NDY3OTU5NTQ0NTRjNGQ0MTZiNDc0MTMxNTU0NTQzNDE3NzQzNTEzMDQ1Nzg0MzdhNDE0YTBhNDI2NzRlNTY0MjQxNTk1NDQxNmM1NjU0NGQ0MjM0NTg0NDU0NDUzNDRkNDQ1NTc5NGQ1NDQ1Nzc0ZTQ0NTU3ODRkNDY2ZjU4NDQ1NDUxMzU0ZDU0NDk3YTRkNTQ0OTdhNGU1NDZiMzE0ZjU2NmY3NzYxNDQ0NTYxNGQ0MjY3NDcwYTQxMzE1NTQ1NDE3Nzc3NTI1MzU3MzUzMDVhNTc3NzY3NTUzMDY0NTk0OTQ2NGE3NjYyMzM1MTY3NTEzMDQ1Nzg0NzZhNDE1OTQyNjc0ZTU2NDI0MTZmNGQ0NTU1NmM3NTY0NDc1NjczNDk0NTRlNzY2MzZlNDI3NjYzNmQ0NjMwMGE2MTU3Mzk3NTRkNTI1MTc3NDU2NzU5NDQ1NjUxNTE0ODQ0NDE3NDU0NTk1NzM1MzA1OTUzNDI0NDYyNDc0Njc5NTk1NDQ1NGM0ZDQxNmI0NzQxMzE1NTQ1NDM0MTc3NDM1MTMwNDU3ODQzN2E0MTRhNDI2NzRlNTY0MjQxNTk1NDBhNDE2YzU2NTQ0ZDQ2NmI3NzQ1Nzc1OTQ4NGI2ZjVhNDk3YTZhMzA0MzQxNTE1OTQ5NGI2ZjVhNDk3YTZhMzA0NDQxNTE2MzQ0NTE2NzQxNDU0MzM2NmU0NTc3NGQ0NDQ5NTk1YTRmNmEyZjY5NTA1NzczNDM3YTYxNDU0YjY5MzcwYTMxNGY2OTRmNTM0YzUyNDY2ODU3NDc2YTYyNmU0MjU2NGE2NjU2NmU2YjU5MzQ3NTMzNDk2YTZiNDQ1OTU5NGMzMDRkNzg0ZjM0NmQ3MTczNzk1OTZhNmM0MjYxNmM1NDU2NTk3ODQ2NTAzMjczNGE0MjRiMzU3YTZjNGI0ZjQyMGE3NTdhNDM0Mjc1NDQ0MTY2NDI2NzRlNTY0ODUzNGQ0NTQ3NDQ0MTU3Njc0MjUxNjk1YTUxN2E1NzU3NzAzMDMwNjk2NjRmNDQ3NDRhNTY1Mzc2MzE0MTYyNGY1MzYzNDc3MjQ0NDI1MzQyNjc0ZTU2NDg1MjM4NDU1MzdhNDI0YTBhNGQ0NTY1Njc1MjYxNDI0NDY4NmI0NjZmNjQ0ODUyNzc2MzdhNmY3NjRjMzI0ZTZjNjM2ZTUyNzA1YTZkNmM2YTU5NTg1MjZjNjM3OTM1MzA2MzZlNTY3YTY0NDc1NjZiNjMzMjU2Nzk2NDZkNmM2YTVhNTg0ZDc1NjE1NzM1MzAwYTVhNTc3Nzc1NTkzMjM5NzQ0YzMwNmM3NTY0NDc1NjczNTUzMDY0NTk1NTZkMzk3NjY0NDU0ZTQyNGM2ZDUyNmM2MzZhNDE2NDQyNjc0ZTU2NDg1MTM0NDU0NjY3NTE1NTQ5NmQ1NTRkMzE2YzcxNjQ0ZTQ5NmU3YTY3Mzc1MzU2MGE1NTcyMzk1MTQ3N2E2YjZlNDI3MTc3Nzc0NDY3NTk0NDU2NTIzMDUwNDE1MTQ4MmY0MjQxNTE0NDQxNjc0NTQ3NGQ0MjQ5NDc0MTMxNTU2NDQ1Nzc0NTQyMmY3NzUxNDk0ZDQxNTk0MjQxNjYzODQzNDE1MTQ1Nzc0MzY3NTk0OTBhNGI2ZjVhNDk3YTZhMzA0NTQxNzc0OTQ0NTM1MTQxNzc1MjY3NDk2ODQxNGY1NzJmMzU1MTZiNTIyYjUzMzk0MzY5NTM0NDYzNGU2ZjZmNzc0Yzc1NTA1MjRjNzM1NzQ3NjYyZjU5NjkzNzQ3NTM1ODM5MzQ0MjY3Nzc1NDc3NjcwYTQxNjk0NTQxMzQ0YTMwNmM3MjQ4NmY0ZDczMmI1ODZmMzU2ZjJmNzM1ODM2NGYzOTUxNTc3ODQ4NTI0MTc2NWE1NTQ3NGY2NDUyNTEzNzYzNzY3MTUyNTg2MTcxNDkzZDBhMmQyZDJkMmQyZDQ1NGU0NDIwNDM0NTUyNTQ0OTQ2NDk0MzQxNTQ0NTJkMmQyZDJkMmQwYTAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAAAAAAAAAAAQAAAAAAAAABAAAAB967BQgzoaYUF7XHQ+EMM4Dy43134ttrlnTwxKaZb1XFAAAAAQAAAAYAAAABnf1UrMkmyvqeL2YcUb+dsUirKCz/dq6729X0+GfydpkAAAAUAAAAAQAYvg8AABsMAAAbDAAAAAAAMTUA", Limits::none());
    println!("{:?}", tx);
    let signed = sign_transaction(
        tx.unwrap(),
        "Test SDF Network ; September 2015",
        &stellar_secret_key,
    );
}
